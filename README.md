# Intervisible-Pathways
Code to run large scale viewshed analysis with ArcGIS.

Code to run the Agent Based Models through the network generated by this analysis can be found at [joshainglis/abm](https://github.com/joshainglis/abm)
Code for visualisation is at [joshainglis/geoplotting](https://github.com/joshainglis/geoplotting)

Other parts of this analysis can be found 

__Developed against ArcGIS 10.3.1__

## Installation
First ensure you have ArcGIS installed and are able to import arcpy and checkout the `Spatial` and `3D` extensions.

```python
import arcpy
CheckOutExtension("Spatial")
CheckOutExtension("3D")
```

Follow [ESRI's instructions](http://desktop.arcgis.com/en/arcmap/10.3/analyze/python/importing-arcpy.htm) 
if you have any issues.

Then clone this repository

```bash
git clone git@github.com:joshainglis/intervisible-pathways.git
```

* Copy `toolboxes\Macro_Viewshed_Analysis.tbx` to `C:\Users\your_user\AppData\Roaming\ESRI\Desktop10.3\ArcToolbox\My Toolboxes\`
* in ArcGIS open the toolboxes panel, right click in the panel and select `Add Toolbox...`.
* Navigate to `Toolboxes > My Toolboxes` and add the `Macro_Viewshed_Analysis.tbx`.
    * The toolbox should now show in the toolbox panel.
* Open the toolbox in the toolbox panel and right click on `Run_Viewshed_Analysis` and select `Properties` from the context menu.
* Go to the `Source` tab and set the Script file to point at `run_analysis.py`
* The toolbox is now ready to use
